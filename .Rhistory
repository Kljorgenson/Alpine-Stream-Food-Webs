scale_fill_brewer(palette = "Dark2") +
scale_color_brewer(palette = "Dark2") +
#annotate(geom="text", x=2, y=0.38, label="a", color="#D95F02") +
#annotate(geom="text", x=3, y=0.29, label="a", color="#D95F02") +
labs(fill = "Resource") + xlab(NULL) +
ylab("Diet Proportion") + theme_bw() +
geom_boxplot(data = df, aes(WS, value))
p100
# Plot diet proportions by hydrologic source
p100 <- means %>% ggplot() +
geom_boxplot(aes(Primary_water_source, value, fill = source)) +
geom_point(aes(Primary_water_source, value, fill = source), cex = 2, shape = 21, position = position_dodge(width = 0.75)) +
scale_fill_brewer(palette = "Dark2") +
scale_color_brewer(palette = "Dark2") +
#annotate(geom="text", x=2, y=0.38, label="a", color="#D95F02") +
#annotate(geom="text", x=3, y=0.29, label="a", color="#D95F02") +
labs(fill = "Resource") + xlab(NULL) +
ylab("Diet Proportion") + theme_bw() +
geom_boxplot(data = df, aes(WS, value, group = name))
p100
# Plot diet proportions by hydrologic source
p100 <- means %>% ggplot() +
geom_boxplot(aes(Primary_water_source, value, fill = source)) +
geom_point(aes(Primary_water_source, value, fill = source), cex = 2, shape = 21, position = position_dodge(width = 0.75)) +
scale_fill_brewer(palette = "Dark2") +
scale_color_brewer(palette = "Dark2") +
#annotate(geom="text", x=2, y=0.38, label="a", color="#D95F02") +
#annotate(geom="text", x=3, y=0.29, label="a", color="#D95F02") +
labs(fill = "Resource") + xlab(NULL) +
ylab("Diet Proportion") + theme_bw() +
geom_boxplot(data = df, aes(WS, value, color = name))
# Plot diet proportions by hydrologic source
p100 <- means %>% ggplot() +
geom_boxplot(aes(Primary_water_source, value, fill = source)) +
geom_point(aes(Primary_water_source, value, fill = source), cex = 2, shape = 21, position = position_dodge(width = 0.75)) +
scale_fill_brewer(palette = "Dark2") +
scale_color_brewer(palette = "Dark2") +
#annotate(geom="text", x=2, y=0.38, label="a", color="#D95F02") +
#annotate(geom="text", x=3, y=0.29, label="a", color="#D95F02") +
labs(fill = "Resource") + xlab(NULL) +
ylab("Diet Proportion") + theme_bw() +
geom_boxplot(data = df, aes(WS, value, color = name))
p100
# Plot diet proportions by hydrologic source
p100 <- means %>% ggplot() +
geom_boxplot(aes(Primary_water_source, value, fill = source)) +
geom_point(aes(Primary_water_source, value, fill = source), cex = 2, shape = 21, position = position_dodge(width = 0.75)) +
scale_fill_brewer(palette = "Dark2") +
scale_color_brewer(palette = "Dark2") +
#annotate(geom="text", x=2, y=0.38, label="a", color="#D95F02") +
#annotate(geom="text", x=3, y=0.29, label="a", color="#D95F02") +
labs(fill = "Resource") + xlab(NULL) +
ylab("Diet Proportion") + theme_bw() +
geom_boxplot(data = df, aes(WS, value, color = name), color = 1)
p100
# Plot diet proportions by hydrologic source
p100 <- means %>% ggplot() +
geom_boxplot(aes(Primary_water_source, value, fill = source)) +
geom_point(aes(Primary_water_source, value, fill = source), cex = 2, shape = 21, position = position_dodge(width = 0.75)) +
scale_fill_brewer(palette = "Dark2") +
scale_color_brewer(palette = "Dark2") +
#annotate(geom="text", x=2, y=0.38, label="a", color="#D95F02") +
#annotate(geom="text", x=3, y=0.29, label="a", color="#D95F02") +
labs(fill = "Resource") + xlab(NULL) +
ylab("Diet Proportion") + theme_bw() +
geom_boxplot(data = df, aes(WS, value, fill = name))
p100
?geom_boxplot
# Plot diet proportions by hydrologic source
p100 <- means %>% ggplot() +
geom_boxplot(aes(Primary_water_source, value, fill = source)) +
geom_point(aes(Primary_water_source, value, fill = source), cex = 2, shape = 21, position = position_dodge(width = 0.75)) +
scale_fill_brewer(palette = "Dark2") +
scale_color_brewer(palette = "Dark2") +
#annotate(geom="text", x=2, y=0.38, label="a", color="#D95F02") +
#annotate(geom="text", x=3, y=0.29, label="a", color="#D95F02") +
labs(fill = "Resource") + xlab(NULL) +
ylab("Diet Proportion") + theme_bw() +
geom_point(data = df, aes(WS, value, fill = name))
p100
# Plot diet proportions by hydrologic source
p100 <- means %>% ggplot() +
geom_boxplot(aes(Primary_water_source, value, fill = source)) +
geom_point(aes(Primary_water_source, value, fill = source), cex = 2, shape = 21, position = position_dodge(width = 0.75)) +
scale_fill_brewer(palette = "Dark2") +
scale_color_brewer(palette = "Dark2") +
#annotate(geom="text", x=2, y=0.38, label="a", color="#D95F02") +
#annotate(geom="text", x=3, y=0.29, label="a", color="#D95F02") +
labs(fill = "Resource") + xlab(NULL) +
ylab("Diet Proportion") + theme_bw() +
geom_point(data = df, aes(WS, value, fill = name), position = position_dodge(width = 0.75))
p100
# Plot diet proportions by hydrologic source
p100 <- means %>% ggplot() +
geom_boxplot(aes(Primary_water_source, value, fill = source)) +
geom_point(aes(Primary_water_source, value, fill = source), cex = 2, shape = 21, position = position_dodge(width = 0.75)) +
scale_fill_brewer(palette = "Dark2") +
scale_color_brewer(palette = "Dark2") +
#annotate(geom="text", x=2, y=0.38, label="a", color="#D95F02") +
#annotate(geom="text", x=3, y=0.29, label="a", color="#D95F02") +
labs(fill = "Resource") + xlab(NULL) +
ylab("Diet Proportion") + theme_bw() +
geom_hline(data = df, aes(WS, value, fill = name), position = position_dodge(width = 0.75))
p100
# Plot diet proportions by hydrologic source
p100 <- means %>% ggplot() +
geom_boxplot(aes(Primary_water_source, value, fill = source)) +
geom_point(aes(Primary_water_source, value, fill = source), cex = 2, shape = 21, position = position_dodge(width = 0.75)) +
scale_fill_brewer(palette = "Dark2") +
scale_color_brewer(palette = "Dark2") +
#annotate(geom="text", x=2, y=0.38, label="a", color="#D95F02") +
#annotate(geom="text", x=3, y=0.29, label="a", color="#D95F02") +
labs(fill = "Resource") + xlab(NULL) +
ylab("Diet Proportion") + theme_bw() +
stat_summary(fun.y = mean, geom = "errorbar", aes(ymax = ..y.., ymin = ..y..),
width = .75, linetype = "dashed")
p100
# Plot diet proportions by hydrologic source
p100 <- means %>% ggplot() +
geom_boxplot(aes(Primary_water_source, value, fill = source)) +
geom_point(aes(Primary_water_source, value, fill = source), cex = 2, shape = 21, position = position_dodge(width = 0.75)) +
scale_fill_brewer(palette = "Dark2") +
scale_color_brewer(palette = "Dark2") +
#annotate(geom="text", x=2, y=0.38, label="a", color="#D95F02") +
#annotate(geom="text", x=3, y=0.29, label="a", color="#D95F02") +
labs(fill = "Resource") + xlab(NULL) +
ylab("Diet Proportion") + theme_bw() +
geom_hline(data = df, aes(WS, value))
p100
?geom_hline
# Plot diet proportions by hydrologic source
p100 <- means %>% ggplot() +
geom_boxplot(aes(Primary_water_source, value, fill = source)) +
geom_point(aes(Primary_water_source, value, fill = source), cex = 2, shape = 21, position = position_dodge(width = 0.75)) +
scale_fill_brewer(palette = "Dark2") +
scale_color_brewer(palette = "Dark2") +
#annotate(geom="text", x=2, y=0.38, label="a", color="#D95F02") +
#annotate(geom="text", x=3, y=0.29, label="a", color="#D95F02") +
labs(fill = "Resource") + xlab(NULL) +
ylab("Diet Proportion") + theme_bw() +
geom_hline(data = df, aes(yintercept = value))
p100
# Plot diet proportions by hydrologic source
p100 <- means %>% ggplot() +
geom_boxplot(aes(Primary_water_source, value, fill = source)) +
geom_point(aes(Primary_water_source, value, fill = source), cex = 2, shape = 21, position = position_dodge(width = 0.75)) +
scale_fill_brewer(palette = "Dark2") +
scale_color_brewer(palette = "Dark2") +
#annotate(geom="text", x=2, y=0.38, label="a", color="#D95F02") +
#annotate(geom="text", x=3, y=0.29, label="a", color="#D95F02") +
labs(fill = "Resource") + xlab(NULL) +
ylab("Diet Proportion") + theme_bw() +
geom_hline(data = df, aes(yintercept = value, x = WS))
# Plot diet proportions by hydrologic source
p100 <- means %>% ggplot() +
geom_boxplot(aes(Primary_water_source, value, fill = source)) +
geom_point(aes(Primary_water_source, value, fill = source), cex = 2, shape = 21, position = position_dodge(width = 0.75)) +
scale_fill_brewer(palette = "Dark2") +
scale_color_brewer(palette = "Dark2") +
#annotate(geom="text", x=2, y=0.38, label="a", color="#D95F02") +
#annotate(geom="text", x=3, y=0.29, label="a", color="#D95F02") +
labs(fill = "Resource") + xlab(NULL) +
ylab("Diet Proportion") + theme_bw() +
geom_boxplot(data = df, aes(WS, value, fill = name), position = position_dodge(width = 0.75))
p100
# Plot diet proportions by hydrologic source
p100 <- means %>% ggplot() +
geom_boxplot(aes(Primary_water_source, value, fill = source)) +
geom_point(aes(Primary_water_source, value, fill = source), cex = 2, shape = 21, position = position_dodge(width = 0.75)) +
scale_fill_brewer(palette = "Dark2") +
scale_color_brewer(palette = "Dark2") +
#annotate(geom="text", x=2, y=0.38, label="a", color="#D95F02") +
#annotate(geom="text", x=3, y=0.29, label="a", color="#D95F02") +
labs(fill = "Resource") + xlab(NULL) +
ylab("Diet Proportion") + theme_bw() +
geom_boxplot(data = df, aes(WS, value, fill = name), width = 3, position = position_dodge(width = 0.75))
p100
# Plot diet proportions by hydrologic source
p100 <- means %>% ggplot() +
geom_boxplot(aes(Primary_water_source, value, fill = source)) +
geom_point(aes(Primary_water_source, value, fill = source), cex = 2, shape = 21, position = position_dodge(width = 0.75)) +
scale_fill_brewer(palette = "Dark2") +
scale_color_brewer(palette = "Dark2") +
#annotate(geom="text", x=2, y=0.38, label="a", color="#D95F02") +
#annotate(geom="text", x=3, y=0.29, label="a", color="#D95F02") +
labs(fill = "Resource") + xlab(NULL) +
ylab("Diet Proportion") + theme_bw() +
geom_boxplot(data = df, aes(WS, value, fill = name), width = 2, position = position_dodge(width = 0.75))
p100
# Plot diet proportions by hydrologic source
p100 <- means %>% ggplot() +
geom_boxplot(aes(Primary_water_source, value, fill = source)) +
geom_point(aes(Primary_water_source, value, fill = source), cex = 2, shape = 21, position = position_dodge(width = 0.75)) +
scale_fill_brewer(palette = "Dark2") +
scale_color_brewer(palette = "Dark2") +
#annotate(geom="text", x=2, y=0.38, label="a", color="#D95F02") +
#annotate(geom="text", x=3, y=0.29, label="a", color="#D95F02") +
labs(fill = "Resource") + xlab(NULL) +
ylab("Diet Proportion") + theme_bw() +
geom_boxplot(data = df, aes(WS, value, fill = name), width = 1, position = position_dodge(width = 0.75))
p100
?geom_boxplot
# Plot diet proportions by hydrologic source
p100 <- means %>% ggplot() +
geom_boxplot(aes(Primary_water_source, value, col = source)) +
geom_point(aes(Primary_water_source, value, fill = source), cex = 2, shape = 21, position = position_dodge(width = 0.75)) +
scale_fill_brewer(palette = "Dark2") +
scale_color_brewer(palette = "Dark2") +
#annotate(geom="text", x=2, y=0.38, label="a", color="#D95F02") +
#annotate(geom="text", x=3, y=0.29, label="a", color="#D95F02") +
labs(fill = "Resource") + xlab(NULL) +
ylab("Diet Proportion") + theme_bw() +
geom_boxplot(data = df, aes(WS, value, fill = name), width = 1, position = position_dodge(width = 0.75))
p100
# Plot diet proportions by hydrologic source
p100 <- means %>% ggplot() +
geom_boxplot(aes(Primary_water_source, value, col = source)) +
geom_point(aes(Primary_water_source, value, col = source), cex = 2, shape = 21, position = position_dodge(width = 0.75)) +
scale_fill_brewer(palette = "Dark2") +
scale_color_brewer(palette = "Dark2") +
#annotate(geom="text", x=2, y=0.38, label="a", color="#D95F02") +
#annotate(geom="text", x=3, y=0.29, label="a", color="#D95F02") +
labs(fill = "Resource") + xlab(NULL) +
ylab("Diet Proportion") + theme_bw() +
geom_boxplot(data = df, aes(WS, value, fill = name), width = 1, position = position_dodge(width = 0.75))
p100
# Plot diet proportions by hydrologic source
p100 <- means %>% ggplot() +
geom_boxplot(aes(Primary_water_source, value, col = source)) +
geom_point(aes(Primary_water_source, value, col = source), cex = 2, shape = 21, position = position_dodge(width = 0.75)) +
scale_fill_brewer(palette = "Dark2") +
scale_color_brewer(palette = "Dark2") +
#annotate(geom="text", x=2, y=0.38, label="a", color="#D95F02") +
#annotate(geom="text", x=3, y=0.29, label="a", color="#D95F02") +
labs(fill = "Resource") + xlab(NULL) +
ylab("Diet Proportion") + theme_bw() +
scale_colour_continuous(guide = "none") +
geom_boxplot(data = df, aes(WS, value, fill = name), width = 1, position = position_dodge(width = 0.75))
p100
# Plot diet proportions by hydrologic source
p100 <- means %>% ggplot() +
geom_boxplot(aes(Primary_water_source, value, col = source)) +
geom_point(aes(Primary_water_source, value, col = source), cex = 2, shape = 21, position = position_dodge(width = 0.75)) +
scale_fill_brewer(palette = "Dark2") +
scale_color_brewer(palette = "Dark2", guide = "none") +
#annotate(geom="text", x=2, y=0.38, label="a", color="#D95F02") +
#annotate(geom="text", x=3, y=0.29, label="a", color="#D95F02") +
labs(fill = "Resource") + xlab(NULL) +
ylab("Diet Proportion") + theme_bw() +
#scale_colour_continuous(guide = "none") +
geom_boxplot(data = df, aes(WS, value, fill = name), width = 1, position = position_dodge(width = 0.75))
p100
# Plot diet proportions by hydrologic source
p100 <- means %>% ggplot() +
geom_boxplot(aes(Primary_water_source, value, col = source)) +
geom_point(aes(Primary_water_source, value, col = source), cex = 2, shape = 21, position = position_dodge(width = 0.75)) +
scale_fill_brewer(palette = "Dark2", guide = "none") +
scale_color_brewer(palette = "Dark2") +
#annotate(geom="text", x=2, y=0.38, label="a", color="#D95F02") +
#annotate(geom="text", x=3, y=0.29, label="a", color="#D95F02") +
labs(fill = "Resource") + xlab(NULL) +
ylab("Diet Proportion") + theme_bw() +
#scale_colour_continuous(guide = "none") +
geom_boxplot(data = df, aes(WS, value, fill = name), width = 1, position = position_dodge(width = 0.75))
p100
ggsave("Output//Paper figures//Diet by Hydro.png", width = 5, height = 3.6)
# Setup
library(tidyverse)
library(DirichletReg)
library(ggtern)
## Create dataframe with diet proportions and biomass
# Load diversity data
div_d <- read.csv("Data//TetonInverts2020.csv")
head(div_d)
div_d <- div_d %>% dplyr::mutate(across(c(L1:L20),~ifelse(is.na(.), 0, 1))) %>%
dplyr::mutate(n = rowSums(across(L1:L20), na.rm = T))
# Change taxa to match diet taxonomic groups
div_dat <- div_d %>% dplyr::mutate(taxa = case_when(startsWith(Taxa, "Rhy") ~ "Rhyacophilidae",
Taxa %in% c("Simuliidae Pupae", "Heterocloeon", "Prosimuliium", "Helodon") ~ "Simuliidae",
Taxa == "Non-Tanypodinae" ~ "Midges",
Taxa == "Chironomidae Pupae" ~ "Midges",
Taxa == "Tipula (Arctotipula)" ~ "Tipula",
Taxa %in% c("1Megarcys", "2Megarcys") ~ "Megarcys",
Taxa == "Nematoda" ~ "Oligochaeta",
!Taxa %in% c("Rhyacophilidae", "Simuliidae Pupae", "Heterocloeon", "Prosimuliium", "Helodon", "Chironomidae Pupae", "Non-Tanypodinae", "Tipula (Arctotipula)","1Megarcys", "2Megarcys") ~ Taxa   )) %>%
dplyr::select(Stream, taxa, Biomass_mg_m2, n) %>% filter(taxa != "Chironomidae Adult") %>% dplyr::rename(site = Stream)
a <- div_dat %>% dplyr::group_by(site, taxa) %>% dplyr::summarise(n = sum(n))
write.csv(a,"bionums.csv")
# Rename stream names so that they match
div_dat$site <- as.factor(div_dat$site)
levels(div_dat$site) <- c("AK Basin",  "Cloudveil", "Delta", "Grizzly", "Middle Teton", "NFTC",
"Paintbrush", "SFTC", "Skillet", "South Cascade RG", "The Gusher", "Wind Cave")
# Merge biomass and diet proportions data
data_di <- read.csv("Data//diet_data_clean.csv")
data_di$site <- as.factor(data_di$site)
levels(data_di$site) <- c("AK Basin","Cloudveil","Delta","Grizzly","NFTC", "Paintbrush", "SFTC", "Skillet", "Wind Cave" )
# Setup
library(tidyverse)
library(DirichletReg)
library(ggtern)
## Create dataframe with diet proportions and biomass
# Load diversity data
div_d <- read.csv("Data//TetonInverts2020.csv")
head(div_d)
div_d <- div_d %>% dplyr::mutate(across(c(L1:L20),~ifelse(is.na(.), 0, 1))) %>%
dplyr::mutate(n = rowSums(across(L1:L20), na.rm = T))
# Change taxa to match diet taxonomic groups
div_dat <- div_d %>% dplyr::mutate(taxa = case_when(startsWith(Taxa, "Rhy") ~ "Rhyacophilidae",
Taxa %in% c("Simuliidae Pupae", "Heterocloeon", "Prosimuliium", "Helodon") ~ "Simuliidae",
Taxa == "Non-Tanypodinae" ~ "Midges",
Taxa == "Chironomidae Pupae" ~ "Midges",
Taxa == "Tipula (Arctotipula)" ~ "Tipula",
Taxa %in% c("1Megarcys", "2Megarcys") ~ "Megarcys",
Taxa == "Nematoda" ~ "Oligochaeta",
!Taxa %in% c("Rhyacophilidae", "Simuliidae Pupae", "Heterocloeon", "Prosimuliium", "Helodon", "Chironomidae Pupae", "Non-Tanypodinae", "Tipula (Arctotipula)","1Megarcys", "2Megarcys") ~ Taxa   )) %>%
dplyr::select(Stream, taxa, Biomass_mg_m2, n) %>% filter(taxa != "Chironomidae Adult") %>% dplyr::rename(site = Stream)
a <- div_dat %>% dplyr::group_by(site, taxa) %>% dplyr::summarise(n = sum(n))
write.csv(a,"bionums.csv")
# Rename stream names so that they match
div_dat$site <- as.factor(div_dat$site)
levels(div_dat$site) <- c("AK Basin",  "Cloudveil", "Delta", "Grizzly", "Middle Teton", "NFTC",
"Paintbrush", "SFTC", "Skillet", "South Cascade RG", "The Gusher", "Wind Cave")
# Merge biomass and diet proportions data
data_di <- read.csv("Data//diet_data_clean.csv")
# Merge biomass and diet proportions data
data_di <- read.csv("Output//diet_data_clean.csv")
data_di$site <- as.factor(data_di$site)
levels(data_di$site) <- c("AK Basin","Cloudveil","Delta","Grizzly","NFTC", "Paintbrush", "SFTC", "Skillet", "Wind Cave" )
head(data_di)
diet_bm_dat <- merge(data_di, div_dat)
head(diet_bm_dat)
diet_bm_dat$Biomass_mg_m2 <- as.numeric(diet_bm_dat$Biomass_mg_m2)
## Calculate biomass supported by each food source
diet_bm_dat$biomass_t = diet_bm_dat$Biomass_mg_m2*diet_bm_dat$Mean # Biomass per source per taxa
head(diet_bm_dat)
div_dat
diet_bm_dat %>% filter(site == "Cloudveil") %>% summarise(tot = sum(biomass_t)) # Check that it sums to 100
diet_bm_dat %>% group_by(site, taxa, source, Mean) %>% summarise(biomass = sum(Biomass_mg_m2),
biomass_t = biomass*Mean)
div_dat$Biomass_mg_m2 <- as.numeric(div_dat$Biomass_mg_m2)
site_bm <- diet_bm_dat %>% group_by(site, source) %>% summarise(biomass_ss = sum(biomass_t, na.rm = TRUE)) # Total biomass at site by source
bm_dat_site <- diet_bm_dat %>% group_by(site) %>% summarise(biomass_s = sum(biomass_t, na.rm = TRUE))
bm_dat <- merge(site_bm, bm_dat_site, all = TRUE)
bm_dat$biomass_per <- bm_dat$biomass_ss/bm_dat$biomass_s # % Biomass by resource
# Add zeroes for Hydrurus
site <- c("SFTC", "Grizzly", "Paintbrush")
Hy_add <- data.frame(site = c("SFTC", "Grizzly", "Paintbrush"),  source = rep("Hydrurus", 3), biomass_per = rep(0, 3))
bm_data <- dplyr::bind_rows(bm_dat, Hy_add)
# Load environmental data and merge
Envi_data <- read.csv("Output//Envi_data.csv")
Envi_data
bm_envi_dat <- merge(Envi_data, bm_data, all = TRUE)
# Plot of site means for different water sources
dodge <- position_dodge(width=0.8)
p2 <- bm_envi_dat %>% ggplot(aes(Primary_water_source, biomass_per, fill = source)) + geom_boxplot(position = dodge) +
geom_point(position = dodge, shape = 21, cex = 2) + theme_bw() +
scale_fill_brewer(palette = "Dark2") +
scale_color_brewer(palette = "Dark2") + xlab(NULL) +
ylab("Biomass (%)") + labs(fill = "Resource")
p2
### Dirichlet regression
# Organize data
spread_bm_dat <- bm_envi_dat %>% select(site, source, biomass_per) %>% spread(key = source, value = biomass_per)
spread_bm_dat
spread_bm_envi_dat <- merge(spread_bm_dat, Envi_data, all = TRUE)
spread_bm_envi_dat
# Plot
ggtern(spread_bm_envi_dat, aes(Biofilm, Hydrurus, CPOM, color = Primary_water_source)) + geom_point()
DB <-DR_data(spread_bm_envi_dat[, 2:4])
plot(DB)
m1b <- DirichReg(DB ~ SPC, spread_bm_envi_dat, model = "common")
summary(m1b)
m6b <- DirichReg(DB ~ Primary_water_source, spread_bm_envi_dat, model = "common")
summary(m6b)
head(spread_bm_envi_dat)
## Plot of site mean diet composition and model fits by hydrologic source
# Reformat data
means <- spread_bm_envi_dat[,c(1,2,3,4,6)] %>% pivot_longer(cols = 2:4, names_to = "source")
# Extract model fits
df <- as.data.frame(predict(m6b))
df$WS <- spread_env_m_dat$Primary_water_source
df <- df %>% pivot_longer(cols = 1:3)
df %>% ggplot(aes(WS, value, color = name)) + geom_boxplot()
p100 <- means %>% ggplot() +
geom_boxplot(aes(Primary_water_source, value, col = source)) +
geom_point(aes(Primary_water_source, value, col = source), cex = 2, shape = 21, position = position_dodge(width = 0.75)) +
scale_fill_brewer(palette = "Dark2", guide = "none") +
scale_color_brewer(palette = "Dark2") +
#annotate(geom="text", x=2, y=0.38, label="a", color="#D95F02") +
#annotate(geom="text", x=3, y=0.29, label="a", color="#D95F02") +
labs(fill = "Resource") + xlab(NULL) +
ylab("Diet Proportion") + theme_bw() +
#scale_colour_continuous(guide = "none") +
geom_boxplot(data = df, aes(WS, value, fill = name), width = 1, position = position_dodge(width = 0.75))
p100
## Plot of site mean biomass proportions and model fits by hydrologic source
# Reformat data
means <- spread_bm_envi_dat[,c(1,2,3,4,6)] %>% pivot_longer(cols = 2:4, names_to = "source")
# Extract model fits
df <- as.data.frame(predict(m6b))
df$WS <- spread_env_m_dat$Primary_water_source
df <- df %>% pivot_longer(cols = 1:3)
df %>% ggplot(aes(WS, value, color = name)) + geom_boxplot()
# Plot biomass proportions by hydrologic source
p100 <- means %>% ggplot() +
geom_boxplot(aes(Primary_water_source, value, col = source)) +
geom_point(aes(Primary_water_source, value, col = source), cex = 2, shape = 21, position = position_dodge(width = 0.75)) +
scale_fill_brewer(palette = "Dark2", guide = "none") +
scale_color_brewer(palette = "Dark2") +
#annotate(geom="text", x=2, y=0.38, label="a", color="#D95F02") +
#annotate(geom="text", x=3, y=0.29, label="a", color="#D95F02") +
labs(fill = "Resource") + xlab(NULL) +
ylab("Diet Proportion") + theme_bw() +
#scale_colour_continuous(guide = "none") +
geom_boxplot(data = df, aes(WS, value, fill = name), width = 1, position = position_dodge(width = 0.75))
p100
ggsave("Output//Paper figures//Biomass by hydro.png", height = 4, width = 5)
# Plot biomass proportions by hydrologic source
p100 <- means %>% ggplot() +
geom_boxplot(aes(Primary_water_source, value, col = source)) +
geom_point(aes(Primary_water_source, value, col = source), cex = 2, shape = 21, position = position_dodge(width = 0.75)) +
scale_fill_brewer(palette = "Dark2", guide = "none") +
scale_color_brewer(palette = "Dark2") +
#annotate(geom="text", x=2, y=0.38, label="a", color="#D95F02") +
#annotate(geom="text", x=3, y=0.29, label="a", color="#D95F02") +
labs(fill = "Resource") + xlab(NULL) +
ylab("Diet Proportion") + theme_bw() +
#scale_colour_continuous(guide = "none") +
geom_boxplot(data = df, aes(WS, value, fill = name), width = 1, position = position_dodge(width = 0.75))
p100
ggsave("Output//Paper figures//Biomass by hydro.png", height = 4, width = 5)
ggsave("Output//Paper figures//Biomass by hydro.png", width = 5, height = 3.6)
# Plot biomass proportions by hydrologic source
p100 <- means %>% ggplot() +
geom_boxplot(aes(Primary_water_source, value, col = source)) +
geom_point(aes(Primary_water_source, value, col = source), cex = 2, shape = 21, position = position_dodge(width = 0.75)) +
scale_fill_brewer(palette = "Dark2", guide = "none") +
scale_color_brewer(palette = "Dark2") +
#annotate(geom="text", x=2, y=0.38, label="a", color="#D95F02") +
#annotate(geom="text", x=3, y=0.29, label="a", color="#D95F02") +
labs(fill = "Resource") + xlab(NULL) +
ylab("Biomass Proportion") + theme_bw() +
#scale_colour_continuous(guide = "none") +
geom_boxplot(data = df, aes(WS, value, fill = name), width = 1, position = position_dodge(width = 0.75))
p100
ggsave("Output//Paper figures//Biomass by hydro.png", width = 5, height = 3.6)
# Plot biomass proportions by hydrologic source
p100 <- means %>% ggplot() +
geom_boxplot(aes(Primary_water_source, value, col = source)) +
geom_point(aes(Primary_water_source, value, col = source), cex = 2, shape = 21, position = position_dodge(width = 0.75)) +
scale_fill_brewer(palette = "Dark2", guide = "none") +
scale_color_brewer(palette = "Dark2") +
#annotate(geom="text", x=2, y=0.38, label="a", color="#D95F02") +
#annotate(geom="text", x=3, y=0.29, label="a", color="#D95F02") +
labs(col = "Resource") + xlab(NULL) +
ylab("Biomass Proportion") + theme_bw() +
#scale_colour_continuous(guide = "none") +
geom_boxplot(data = df, aes(WS, value, fill = name), width = 1, position = position_dodge(width = 0.75))
# Plot biomass proportions by hydrologic source
p100 <- means %>% ggplot() +
geom_boxplot(aes(Primary_water_source, value, col = source)) +
geom_point(aes(Primary_water_source, value, col = source), cex = 2, shape = 21, position = position_dodge(width = 0.75)) +
scale_fill_brewer(palette = "Dark2", guide = "none") +
scale_color_brewer(palette = "Dark2") +
#annotate(geom="text", x=2, y=0.38, label="a", color="#D95F02") +
#annotate(geom="text", x=3, y=0.29, label="a", color="#D95F02") +
labs(col = "Resource") + xlab(NULL) +
ylab("Biomass Proportion") + theme_bw() +
#scale_colour_continuous(guide = "none") +
geom_boxplot(data = df, aes(WS, value, fill = name), width = 1, position = position_dodge(width = 0.75))
p100
ggsave("Output//Paper figures//Biomass by hydro.png", width = 5, height = 3.6)
# Plot biomass proportions by hydrologic source
p100 <- means %>% ggplot() +
geom_boxplot(aes(Primary_water_source, value, col = source)) +
geom_point(aes(Primary_water_source, value, col = source), cex = 2, shape = 21, position = position_dodge(width = 0.75)) +
scale_fill_brewer(palette = "Dark2", guide = "none") +
scale_color_brewer(palette = "Dark2", labels = c("Biofilm", "CPOM", expression(italic("Hydrurus")))) +
#annotate(geom="text", x=2, y=0.38, label="a", color="#D95F02") +
#annotate(geom="text", x=3, y=0.29, label="a", color="#D95F02") +
labs(col = "Resource") + xlab(NULL) +
ylab("Biomass Proportion") + theme_bw() +
#scale_colour_continuous(guide = "none") +
geom_boxplot(data = df, aes(WS, value, fill = name), width = 1, position = position_dodge(width = 0.75))
p100
ggsave("Output//Paper figures//Biomass by hydro.png", width = 5, height = 3.6)
m6b <- DirichReg(DB ~ Primary_water_source, spread_bm_envi_dat, model = "common")
summary(m6b)
m6b <- DirichReg(DB ~ Primary_water_source, spread_bm_envi_dat, model = "alternative")
summary(m6b)
?DirichReg
m6b <- DirichReg(DB ~ Primary_water_source, spread_bm_envi_dat, model = "alternative", base = 2)
summary(m6b)
m6b <- DirichReg(DB ~ Primary_water_source, spread_bm_envi_dat, model = "alternative", base = 3)
summary(m6b)
m6b <- DirichReg(DB ~ Primary_water_source, spread_bm_envi_dat, model = "common")
summary(m6b)
spread_bm_envi_dat$Primary_water_source <- factor(spread_bm_envi_dat$Primary_water_source, levels=c( "Snowmelt", "Glacier","Subterranean ice"))
m6b <- DirichReg(DB ~ Primary_water_source, spread_bm_envi_dat, model = "common")
summary(m6b)
m6b <- DirichReg(DB ~ Primary_water_source, spread_bm_envi_dat, model = "common",
control = list(sv=c(iterlim = 1000)))
control = list(iterlim = 1000)
m7b <- DirichReg(DB ~ Elevation, spread_bm_envi_dat, model = "common")
m6b <- DirichReg(DB ~ Primary_water_source, spread_bm_envi_dat, model = "common",
control = list(iterlim = 1000))
summary(m6b)
m6b <- DirichReg(DB ~ Primary_water_source, spread_bm_envi_dat, model = "common",
control = list(iterlim = 5000))
summary(m6b)
m6b <- DirichReg(DB ~ Primary_water_source, spread_bm_envi_dat, model = "common")
summary(m6b)
